<!doctype html>
<html>


<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title> Cost of living survey</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <link rel="stylesheet" href="pico.css">

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="js/leaflet.ajax.min.js"></script>
    <script>
        var layout = {
            title: "How hours worked affect finances",
            showlegend: true
        };
        function cb(selection) {
            $.getJSON({
                url: "/callback", data: { 'data': selection }, success: function (result) {
                    Plotly.newPlot('chart', result, layout);;
                }
            });
        }
    </script>

</head>



<body>

    <section id="header">
        <div class="container">
            <h1>Cost of living survey</h1>
        </div>
    </section>
    <main class="container">
        <div class="grid">
            <div>
                <h2>Rents in Bristol are among the highest in the UK. The average student pays Â£720 a month</h2>
            </div>
            <div id="map"> </div>

        </div>
        <form>
            <!-- <h1>How hours worked affect finances</h1>
        <h2>Set the hours worked per week</h2> -->

            <div id="chart" class="chart"></div>
            <div class="slidecontainer">
                <input type="range" min="0" max="10" value="5" class="slider" id="myRange" ,
                    onchange="graphplotter(this.value)">
            </div>

            <div class="sliderlabel" id="demo"></div>
        </form>



    </main>


</body>

<script>
    function graphplotter(hours) {
        var slider = document.getElementById("myRange");
        var output = document.getElementById("demo");

        output.innerHTML = slider.value.concat(" hours");
        slider.oninput = function () {
            output.innerHTML = this.value.concat(" hours");
        }

        var stipend = {
            x: ["Fully funded", "Part time", "Unfunded"],
            y: [1472, 736, 0],
            name: "Stipend",
            type: "bar"
        }
        var earnings = {
            x: ["Fully funded", "Part time", "Unfunded"],
            y: [14 * hours * 4, 14 * hours * 4, 14 * hours * 4],
            name: "Earnings",
            type: "bar"
        }
        var data = [stipend, earnings];
        var layout = {
            barmode: 'stack',
            title: "How hours worked affect finances",
            yaxis: { range: [0, 2500] },
            shapes: [
                {
                    type: 'line',
                    x0: -0.5,
                    y0: 2400,
                    x1: 2.5,
                    y1: 2400,
                    line: {
                        width: 4,
                        dash: 'dot',
                        color: 'rgb(255, 0, 0)',
                    },
                    label: {
                        text: 'Affordable housing threshold',
                        font: { size: 10, color: 'rgb(255, 0, 0)' },
                    }

                }

            ],
            annotations: [
                {
                    x: 0,
                    y: 2500,
                    xref: 'x',
                    yref: 'y',
                    text: 'Affordable housing threshold',
                    font: { size: 15, color: 'rgb(255, 0, 0)' },
                    showarrow: false,
                }
            ]
        };
        Plotly.newPlot('chart', data, layout, { displayModeBar: false });
    }
</script>

<script src="js/mapscript.js"></script>

<script>
    var slider = document.getElementById("myRange");
    graphplotter(slider.value);
</script>


</html>